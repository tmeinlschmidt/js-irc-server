_ = require('underscore-min')

var ChanServ = function(irc) {
  this._irc = irc;
}

ChanServ.prototype.help = function() {
  return "***** ChanServ Help *****\n\
  ChanServ gives normal users the ability to maintain control\n\
  of a channel, without the need of a bot. Channel takeovers are\n\
  virtually impossible when a channel is registered with ChanServ.".split(/\n/);
}

ChanServ.prototype._help = function(params) {
  if (params.length > 0) {
    // show help for given command
    this._irc.sendClientMessage('NOTICE', ':Help for '+params[0]);
    return;
  }
  _.each(this.help(), function(line) {
    this._irc.sendClientMessage('NOTICE', ':'+line);
  }, this);
}

ChanServ.prototype._unknown = function(params) {
  this._irc.sendClientMessage('NOTICE', ':Invalid command. Use /msg ChanServ help for a command listing.');
}

ChanServ.prototype.process = function(params) {
  if (params.length == 0) return;
  var cmd = params[0];
  params.shift();
  switch(cmd.toUpperCase()) {
    case 'HELP': this._help(params);break;
    default:
      this._unknown(params);break;
  }
}

module.exports = ChanServ
